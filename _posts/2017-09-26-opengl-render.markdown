---
layout: post
title:  "OPENGL 渲染管线"
date:   2017-09-26 21:12:01 +0800
tags: opengl
categories: 读书总结
---

OPENGL是图形硬件的一种软件接口，是计算机3D呈像较为流行的一种技术。它隐藏了图形呈现中许多复杂计算的细节，提供了与现实世界相通的一些概念来操作基中的元素。

<!--break-->

OPENGL 更像是一个状态机，它维护了许多与当前环境相关的状态信息。我们可以设置它，在这之后。只要不进行更改，它便一值是这个状态。比如当前绘图的颜色信息、绘图模式、光照信息、纹理等等。

OPENGL会使用一系列操作，将绘制的数据渲染成一个复杂的三维场景，这个流程被称为渲染管线。

OPEN的渲染管线被分为两个部分，顶点数据和像素数据，它们一开始分别进行处理，然后经进光栅化、片段操作后进入频缓冲区。

## OPENGL基础模型绘制

对于三维世界的物体，OPENGL中以一系列的数组来描述。基中包含顶点数组，颜色数组、法线向量数组、雾数组、纹理数组、起点边数组。OPENGL提供了对这些数据统一管理的方式，可以将它们装进一个数组，用跨距的形式取对应的数据。

### 基础状态设置

对于设置好的顶点数据，在绘制之前要设置绘制模式，使用不同的模式，绘制出的模型可能完全不同。如：指定了以三角面模式绘制，则绘制出来的是三角面的模型。当然还可以选择四角面，甚至可以选择多边形模式将所有点连成一个多边型。


### 顶点数组

OPENGL使用欧几里得空间表描述顶点数据，每个顶点被表示为(x,y,z,w) w默认为1。因为启用w坐标能简化变换运算。

### 缓冲区对像

OPENGL运行方式是一种客户端，服务器模式。负责绘图的可以理解成是一个客户端。服务器发送绘图指令给客户端，经OPENGL计算后渲染出来。在大多数情况下，数据存放在服务器上，在被使用时才被复制到客户端。这是很影响效率的，缓冲区对像就很好的解决了这一问题。


## 视图变换及模型变换

对于所有三维物体的移动、缩放、旋转都是变换，OPENGL使用一个4x4的矩阵表示这种变换，对物体进行多次变换每次变换相当于是当前变换矩阵右乘这个变换矩阵。
视图变换指的是对摄像机信息的变换，摄像机定义了一个视景体。我们通过指定它的视广角、视线方向、纵横比以及近截面和远截面来指定这个视景体。改变这个视景体可以理解为进行了视图变换。

## 投影及视口变换

投影变换对视景体中的不可见元素进行裁剪，以减少不必要的开销，可以在视景体内指定特定裁剪平面。裁剪操作会重新定义多边形的边。完成这些操作后，投影操作使用环境中的状态信息对模型进行着色、应用光照及纹理等。

视口变换是指对投影生成的图像进行的裁剪、缩放、或移动操作，视口属于窗体。

## 颜色与光照

OPENGL中，光分为三种，环境光、散射光、反射光。物体接受环境光照射，根据物体表面法线计算物体表面的颜色(反射光)。散射光是光在环境中经过多次反射存在于环境中的光。OPENGL默认支持8个光源。光照计算要对每个顶点进行计算，因此每多增加一个光源，对性能的影响是很大的。
